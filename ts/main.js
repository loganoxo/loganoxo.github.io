(()=>{var q=e=>{e.classList.contains("link-image")&&(e.addEventListener("error",t=>{u(t.target,!0)}),e.complete?u(e,!1):e.addEventListener("load",t=>{u(t.target,!0)}))},u=(e,t)=>{let i=20,l=20,n=e.naturalWidth,o=e.naturalHeight;if(e.width=n,e.height=o,n!==0&&o!==0&&(i=Math.round(n*100/o),l=Math.round(n*240/o)),e.setAttribute("data-flex-grow",`${i}`),e.setAttribute("data-flex-basis",`${l}px`),t){let r=B(e);r.style.setProperty("flex-grow",`${i}`),r.style.setProperty("flex-basis",`${l}px`)}};function B(e){for(let t=0;t<3&&e.parentElement;t++)if(e=e.parentElement,e.tagName.toLowerCase()==="figure"&&e.classList.contains("gallery-image"))return e;return null}var w=q;var f=class e{galleryUID;items=[];constructor(t,i=1){if(window.PhotoSwipe==null||window.PhotoSwipeUI_Default==null){console.error("PhotoSwipe lib not loaded.");return}this.galleryUID=i,this.loadItems(t),this.bindClick()}loadItems(t){this.items=[];let i=t.querySelectorAll("figure.gallery-image");for(let l of i){let n=l.querySelector("figcaption"),o=l.querySelector("img"),r={w:parseInt(o.getAttribute("width")),h:parseInt(o.getAttribute("height")),src:o.src,msrc:o.getAttribute("data-thumb")||o.src,el:l,ifLink:o.classList.contains("link-image")};n&&(r.title=n.innerHTML),this.items.push(r)}}open(t){let i=document.querySelector(".pswp");new window.PhotoSwipe(i,window.PhotoSwipeUI_Default,this.items,{index:t,galleryUID:this.galleryUID,getThumbBoundsFn:n=>{let o=this.items[n].el.getElementsByTagName("img")[0],r=window.pageYOffset||document.documentElement.scrollTop,s=o.getBoundingClientRect();return{x:s.left,y:s.top+r,w:s.width}}}).init()}bindClick(){for(let[t,i]of this.items.entries())i.el.querySelector("a").addEventListener("click",n=>{n.preventDefault(),this.open(t)})}static createGallery(t){let i=t.querySelectorAll("img.gallery-image");for(let o of Array.from(i)){w(o);let r=o.closest("p");if(!r||!t.contains(r))continue;r.textContent.trim()==""&&r.classList.add("no-text");let s=r.classList.contains("no-text"),m=o.parentElement.tagName=="A",d=o,c=document.createElement("figure");if(c.style.setProperty("flex-grow",o.getAttribute("data-flex-grow")||"1"),c.style.setProperty("flex-basis",o.getAttribute("data-flex-basis")||"0"),m&&(d=o.parentElement),d.parentElement.insertBefore(c,d),c.appendChild(d),o.hasAttribute("alt")){let a=document.createElement("figcaption");a.innerText=o.getAttribute("alt"),c.appendChild(a)}if(!m){c.className="gallery-image";let a=document.createElement("a");a.href=o.src,a.setAttribute("target","_blank"),o.parentNode.insertBefore(a,o),a.appendChild(o)}}let l=t.querySelectorAll("figure.gallery-image"),n=[];for(let o of l)n.length?o.previousElementSibling===n[n.length-1]?n.push(o):n.length&&(e.wrap(n),n=[o]):n=[o];n.length>0&&e.wrap(n)}static wrap(t){let i=document.createElement("div");i.className="gallery";let l=t[0].parentNode,n=t[0];l.insertBefore(i,n);for(let o of t)i.appendChild(o)}},p=f;var D=e=>{let t=250,i=document.createElement("button");i.classList.add("my-code-fold"),i.classList.add("expand1"),i.addEventListener("click",l=>{let n=l.target,r=N(n).querySelector("div.chroma"),s=r.clientHeight;n.classList.contains("expand1")?r.clientHeight>t?(r.style.height=`${t}px`,r.style.overflow="scroll",n.classList.remove("expand1"),n.classList.add("expand2")):(r.style.height="0px",r.style.overflow="hidden",n.classList.remove("expand1"),n.classList.add("expand3")):n.classList.contains("expand2")?(r.style.height="20px",r.style.overflow="hidden",n.classList.remove("expand2"),n.classList.add("expand3")):n.classList.contains("expand3")&&(r.style.height="100%",r.style.overflow="auto",n.classList.remove("expand3"),n.classList.add("expand1"))}),e.appendChild(i)};function N(e){for(let t=0;t<2&&e.parentElement;t++)if(e=e.parentElement,e.tagName.toLowerCase()==="div"&&e.classList.contains("highlight"))return e;return null}var v=D;var F=(e,t=500)=>{e.classList.add("transiting"),e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",window.setTimeout(()=>{e.classList.remove("show"),e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("transiting")},t)},_=(e,t=500)=>{e.classList.add("transiting"),e.style.removeProperty("display"),e.classList.add("show");let i=e.offsetHeight;e.style.overflow="hidden",e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",e.offsetHeight,e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=i+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("transiting")},t)},R=(e,t=500)=>window.getComputedStyle(e).display==="none"?_(e,t):F(e,t);function E(){let e=document.getElementById("toggle-menu");e&&e.addEventListener("click",()=>{document.getElementById("main-menu").classList.contains("transiting")||(document.body.classList.toggle("show-menu"),R(document.getElementById("main-menu"),300),e.classList.toggle("is-active"))})}function O(e,t,i){var l=document.createElement(e);for(let n in t)if(n&&t.hasOwnProperty(n)){let o=t[n];n=="dangerouslySetInnerHTML"?l.innerHTML=o.__html:o===!0?l.setAttribute(n,n):o!==!1&&o!=null&&l.setAttribute(n,o.toString())}for(let n=2;n<arguments.length;n++){let o=arguments[n];o&&l.appendChild(o.nodeType==null?document.createTextNode(o.toString()):o)}return l}var L=O;function S(){let e=document.querySelector("body"),t=e.firstChild,i=document.createElement("canvas");return e.insertBefore(i,t.nextSibling),i.style.cssText="position: fixed;top: 0;left: 0; width: 100%;height: 100%;pointer-events: none;z-index:-1000;",i}function T(e){let t=S(),i=t.getContext("2d");t.width=window.innerWidth,t.height=window.innerHeight;let l=e.clientX,n=e.clientY,r=Math.hypot(Math.max(l,t.width-l),Math.max(n,t.height-n)),s=25,m=function(){i.clearRect(0,0,t.width,t.height),i.fillStyle="#000",i.fillRect(0,0,t.width,t.height),i.beginPath(),i.arc(l,n,r,0,Math.PI*2),i.fillStyle="#fff",i.fill(),i.closePath(),r-=s,r<=0?(cancelAnimationFrame(d),t.remove()):d=requestAnimationFrame(m)},d=requestAnimationFrame(m)}function x(e,t){let i=S(),l=i.getContext("2d");i.width=window.innerWidth,i.height=window.innerHeight;let n=e.clientX,o=e.clientY,r=Math.hypot(Math.max(n,i.width-n),Math.max(o,i.height-o)),s=0,m=25,d=!1,c=function(){l.clearRect(0,0,i.width,i.height),l.fillStyle="#000",l.fillRect(0,0,i.width,i.height),l.beginPath(),l.arc(n,o,s,0,Math.PI*2),l.fillStyle="#fff",l.fill(),l.closePath(),s+=m,!d&&s>=r/2&&(t(),d=!0),s>r?(cancelAnimationFrame(a),i.remove()):a=requestAnimationFrame(c)},a=requestAnimationFrame(c)}var y=class{localStorageKey="StackColorScheme";currentScheme;systemPreferScheme;constructor(t){this.bindMatchMedia(),this.currentScheme=this.getSavedScheme(),this.systemPreferScheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",this.dispatchEvent(document.documentElement.dataset.scheme),t&&this.bindClick(t),document.body.style.transition==""&&document.body.style.setProperty("transition","background-color .3s ease")}saveScheme(){localStorage.setItem(this.localStorageKey,this.currentScheme)}bindClick(t){t.addEventListener("click",i=>{this.isDark()?this.currentScheme="light":this.currentScheme="dark",this.clip(this.setBodyClass,i),this.currentScheme==this.systemPreferScheme&&(this.currentScheme="auto"),this.saveScheme()})}isDark(){return this.currentScheme=="dark"||this.currentScheme=="auto"&&this.systemPreferScheme=="dark"}dispatchEvent(t){let i=new CustomEvent("onColorSchemeChange",{detail:t});window.dispatchEvent(i)}setBodyClass(){this.isDark()?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light",this.dispatchEvent(document.documentElement.dataset.scheme)}getSavedScheme(){let t=localStorage.getItem(this.localStorageKey);return t=="light"||t=="dark"||t=="auto"?t:"auto"}bindMatchMedia(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{t.matches?this.systemPreferScheme="dark":this.systemPreferScheme="light",this.setBodyClass()})}clip(t,i){let l=i.clientX,n=i.clientY,o=Math.hypot(Math.max(l,innerWidth-l),Math.max(n,innerHeight-n));document.documentElement.style.setProperty("--x",l+"px"),document.documentElement.style.setProperty("--y",n+"px"),document.documentElement.style.setProperty("--r",o+"px"),document.startViewTransition?document.startViewTransition(()=>{t.call(this)}):this.currentScheme==="light"?x(i,()=>{t.call(this)}):(t.call(this),T(i))}},b=y;function h(e){let t;return()=>{t&&window.cancelAnimationFrame(t),t=window.requestAnimationFrame(()=>e())}}var U=".article-content h1[id], .article-content h2[id], .article-content h3[id], .article-content h4[id], .article-content h5[id], .article-content h6[id]",M="#TableOfContents",H="#TableOfContents li",k="active-class";function W(e,t){let i=e.querySelector("a").offsetHeight,l=e.offsetTop-t.offsetHeight/2+i/2-t.offsetTop;l<0&&(l=0),t.scrollTo({top:l,behavior:"smooth"})}function Y(e){let t={};return e.forEach(i=>{let n=i.querySelector("a").getAttribute("href");n.startsWith("#")&&(t[n.slice(1)]=i)}),t}function P(e){let t=[];return e.forEach(i=>{t.push({id:i.id,offset:i.offsetTop})}),t.sort((i,l)=>i.offset-l.offset),t}function C(){let e=document.querySelectorAll(U);if(!e){console.warn("No header matched query",e);return}let t=document.querySelector(M);if(!t){console.warn("No toc matched query",M);return}let i=document.querySelectorAll(H);if(!i){console.warn("No navigation matched query",H);return}let l=P(e),n=!1;t.addEventListener("mouseenter",h(()=>n=!0)),t.addEventListener("mouseleave",h(()=>n=!1));let o,r=Y(i);function s(){let d=document.documentElement.scrollTop||document.body.scrollTop,c;l.forEach(g=>{d>=g.offset-20&&(c=document.getElementById(g.id))});let a;c&&(a=r[c.id]),c&&!a?console.debug("No link found for section",c):a!==o&&(o&&o.classList.remove(k),a&&(a.classList.add(k),n||W(a,t)),o=a)}window.addEventListener("scroll",h(s));function m(){l=P(e),s()}window.addEventListener("resize",h(m))}var X="a[href]";function I(){document.querySelectorAll(X).forEach(e=>{e.getAttribute("href").startsWith("#")&&e.addEventListener("click",i=>{i.preventDefault();let l=decodeURI(e.getAttribute("href").substring(1)),n=document.getElementById(l),o=n.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;window.history.pushState({},"",e.getAttribute("href")),scrollTo({top:o,behavior:"smooth"})})})}var A={init:()=>{E();let e=document.querySelector(".article-content");if(e){p.createGallery(e);let n=e.querySelectorAll("div.gallery");for(let o=0;o<n.length;o++){let r=n[o];new p(r,o)}I(),C()}let t=document.querySelectorAll(".article-content div.highlight"),i="Copy",l="Copied!";t.forEach(n=>{v(n);let o=document.createElement("button");o.innerHTML=i,o.classList.add("copyCodeButton"),n.appendChild(o);let r=n.querySelector("code[data-lang]");r&&o.addEventListener("click",()=>{navigator.clipboard.writeText(r.textContent).then(()=>{o.textContent=l,setTimeout(()=>{o.textContent=i},1e3)}).catch(s=>{alert(s),console.log("Something went wrong",s)})})}),new b(document.getElementById("dark-mode-toggle"))}};window.addEventListener("load",()=>{setTimeout(function(){A.init()},0)});window.Stack=A;window.createElement=L;})();
/*!
*   Hugo Theme Stack
*
*   @author: Jimmy Cai
*   @website: https://jimmycai.com
*   @link: https://github.com/CaiJimmy/hugo-theme-stack
*/
