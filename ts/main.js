(()=>{var u=class t{galleryUID;items=[];constructor(e,n=1){if(window.PhotoSwipe==null||window.PhotoSwipeUI_Default==null){console.error("PhotoSwipe lib not loaded.");return}this.galleryUID=n,this.loadItems(e),this.bindClick()}loadItems(e){this.items=[];let n=e.querySelectorAll("figure.gallery-image");for(let l of n){let i=l.querySelector("figcaption"),o=l.querySelector("img"),r={w:parseInt(o.getAttribute("width")),h:parseInt(o.getAttribute("height")),src:o.src,msrc:o.getAttribute("data-thumb")||o.src,el:l,ifLink:o.classList.contains("link-image"),imgEl:o};i&&(r.title=i.innerHTML),this.items.push(r)}}bindClick(){for(let[e,n]of this.items.entries())n.ifLink?this.linkImg(n.imgEl,e):(n.w=n.w*3,n.h=n.h*3,n.el.querySelector("a").addEventListener("click",i=>{i.preventDefault(),this.open(e)}))}open(e){let n=document.querySelector(".pswp");new window.PhotoSwipe(n,window.PhotoSwipeUI_Default,this.items,{index:e,galleryUID:this.galleryUID,closeOnScroll:!1,getThumbBoundsFn:i=>{let o=this.items[i].el.getElementsByTagName("img")[0],r=window.pageYOffset||document.documentElement.scrollTop,s=o.getBoundingClientRect();return{x:s.left,y:s.top+r,w:s.width}}}).init()}linkImg(e,n){e.classList.contains("link-image")&&(e.addEventListener("error",l=>{this.linkImgHandle(l.target,n)}),e.complete?this.linkImgHandle(e,n):e.addEventListener("load",l=>{this.linkImgHandle(l.target,n)}))}linkImgHandle(e,n){let l=20,i=20,o=e.naturalWidth,r=e.naturalHeight;e.width=o,e.height=r,o!==0&&r!==0&&(l=Math.round(o*100/r),i=Math.round(o*240/r)),e.setAttribute("data-flex-grow",`${l}`),e.setAttribute("data-flex-basis",`${i}px`);let s=this.findNearestAnchor(e);s.style.setProperty("flex-grow",`${l}`),s.style.setProperty("flex-basis",`${i}px`),this.items[n].w=o*3,this.items[n].h=r*3,this.items[n].el.querySelector("a").addEventListener("click",d=>{d.preventDefault(),this.open(n)})}findNearestAnchor(e){for(let n=0;n<3&&e.parentElement;n++)if(e=e.parentElement,e.tagName.toLowerCase()==="figure"&&e.classList.contains("gallery-image"))return e;return null}static createGallery(e){let n=e.querySelectorAll("img.gallery-image");for(let o of Array.from(n)){let r=o.closest("p");if(!r||!e.contains(r))continue;r.textContent.trim()==""&&r.classList.add("no-text");let s=r.classList.contains("no-text"),m=o.parentElement.tagName=="A",d=o,c=document.createElement("figure");if(c.style.setProperty("flex-grow",o.getAttribute("data-flex-grow")||"1"),c.style.setProperty("flex-basis",o.getAttribute("data-flex-basis")||"0"),m&&(d=o.parentElement),d.parentElement.insertBefore(c,d),c.appendChild(d),o.hasAttribute("alt")){let a=document.createElement("figcaption");a.innerText=o.getAttribute("alt"),c.appendChild(a)}if(!m){c.className="gallery-image";let a=document.createElement("a");a.href=o.src,a.setAttribute("target","_blank"),o.parentNode.insertBefore(a,o),a.appendChild(o)}}let l=e.querySelectorAll("figure.gallery-image"),i=[];for(let o of l)i.length?o.previousElementSibling===i[i.length-1]?i.push(o):i.length&&(t.wrap(i),i=[o]):i=[o];i.length>0&&t.wrap(i)}static wrap(e){let n=document.createElement("div");n.className="gallery";let l=e[0].parentNode,i=e[0];l.insertBefore(n,i);for(let o of e)n.appendChild(o)}},f=u;var I=t=>{let e=250,n=document.createElement("button");n.classList.add("my-code-fold"),n.classList.add("expand1"),n.addEventListener("click",l=>{let i=l.target,r=A(i).querySelector("div.chroma"),s=r.clientHeight;i.classList.contains("expand1")?r.clientHeight>e?(r.style.height=`${e}px`,r.style.overflow="scroll",i.classList.remove("expand1"),i.classList.add("expand2")):(r.style.height="0px",r.style.overflow="hidden",i.classList.remove("expand1"),i.classList.add("expand3")):i.classList.contains("expand2")?(r.style.height="20px",r.style.overflow="hidden",i.classList.remove("expand2"),i.classList.add("expand3")):i.classList.contains("expand3")&&(r.style.height="100%",r.style.overflow="auto",i.classList.remove("expand3"),i.classList.add("expand1"))}),t.appendChild(n)};function A(t){for(let e=0;e<2&&t.parentElement;e++)if(t=t.parentElement,t.tagName.toLowerCase()==="div"&&t.classList.contains("highlight"))return t;return null}var y=I;var q=(t,e=500)=>{t.classList.add("transiting"),t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=t.offsetHeight+"px",t.offsetHeight,t.style.overflow="hidden",t.style.height="0",t.style.paddingTop="0",t.style.paddingBottom="0",t.style.marginTop="0",t.style.marginBottom="0",window.setTimeout(()=>{t.classList.remove("show"),t.style.removeProperty("height"),t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("transiting")},e)},B=(t,e=500)=>{t.classList.add("transiting"),t.style.removeProperty("display"),t.classList.add("show");let n=t.offsetHeight;t.style.overflow="hidden",t.style.height="0",t.style.paddingTop="0",t.style.paddingBottom="0",t.style.marginTop="0",t.style.marginBottom="0",t.offsetHeight,t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=n+"px",t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),window.setTimeout(()=>{t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("transiting")},e)},D=(t,e=500)=>window.getComputedStyle(t).display==="none"?B(t,e):q(t,e);function w(){let t=document.getElementById("toggle-menu");t&&t.addEventListener("click",()=>{document.getElementById("main-menu").classList.contains("transiting")||(document.body.classList.toggle("show-menu"),D(document.getElementById("main-menu"),300),t.classList.toggle("is-active"))})}function N(t,e,n){var l=document.createElement(t);for(let i in e)if(i&&e.hasOwnProperty(i)){let o=e[i];i=="dangerouslySetInnerHTML"?l.innerHTML=o.__html:o===!0?l.setAttribute(i,i):o!==!1&&o!=null&&l.setAttribute(i,o.toString())}for(let i=2;i<arguments.length;i++){let o=arguments[i];o&&l.appendChild(o.nodeType==null?document.createTextNode(o.toString()):o)}return l}var E=N;function v(){let t=document.querySelector("body"),e=t.firstChild,n=document.createElement("canvas");return t.insertBefore(n,e.nextSibling),n.style.cssText="position: fixed;top: 0;left: 0; width: 100%;height: 100%;pointer-events: none;z-index:-1000;",n}function L(t){let e=v(),n=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;let l=t.clientX,i=t.clientY,r=Math.hypot(Math.max(l,e.width-l),Math.max(i,e.height-i)),s=25,m=function(){n.clearRect(0,0,e.width,e.height),n.fillStyle="#000",n.fillRect(0,0,e.width,e.height),n.beginPath(),n.arc(l,i,r,0,Math.PI*2),n.fillStyle="#fff",n.fill(),n.closePath(),r-=s,r<=0?(cancelAnimationFrame(d),e.remove()):d=requestAnimationFrame(m)},d=requestAnimationFrame(m)}function S(t,e){let n=v(),l=n.getContext("2d");n.width=window.innerWidth,n.height=window.innerHeight;let i=t.clientX,o=t.clientY,r=Math.hypot(Math.max(i,n.width-i),Math.max(o,n.height-o)),s=0,m=25,d=!1,c=function(){l.clearRect(0,0,n.width,n.height),l.fillStyle="#000",l.fillRect(0,0,n.width,n.height),l.beginPath(),l.arc(i,o,s,0,Math.PI*2),l.fillStyle="#fff",l.fill(),l.closePath(),s+=m,!d&&s>=r/2&&(e(),d=!0),s>r?(cancelAnimationFrame(a),n.remove()):a=requestAnimationFrame(c)},a=requestAnimationFrame(c)}var p=class{localStorageKey="StackColorScheme";currentScheme;systemPreferScheme;constructor(e){this.bindMatchMedia(),this.currentScheme=this.getSavedScheme(),this.systemPreferScheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",this.dispatchEvent(document.documentElement.dataset.scheme),e&&this.bindClick(e),document.body.style.transition==""&&document.body.style.setProperty("transition","background-color .3s ease")}saveScheme(){localStorage.setItem(this.localStorageKey,this.currentScheme)}bindClick(e){e.addEventListener("click",n=>{this.isDark()?this.currentScheme="light":this.currentScheme="dark",this.clip(this.setBodyClass,n),this.currentScheme==this.systemPreferScheme&&(this.currentScheme="auto"),this.saveScheme()})}isDark(){return this.currentScheme=="dark"||this.currentScheme=="auto"&&this.systemPreferScheme=="dark"}dispatchEvent(e){let n=new CustomEvent("onColorSchemeChange",{detail:e});window.dispatchEvent(n)}setBodyClass(){this.isDark()?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light",this.dispatchEvent(document.documentElement.dataset.scheme)}getSavedScheme(){let e=localStorage.getItem(this.localStorageKey);return e=="light"||e=="dark"||e=="auto"?e:"auto"}bindMatchMedia(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?this.systemPreferScheme="dark":this.systemPreferScheme="light",this.setBodyClass()})}clip(e,n){let l=n.clientX,i=n.clientY,o=Math.hypot(Math.max(l,innerWidth-l),Math.max(i,innerHeight-i));document.documentElement.style.setProperty("--x",l+"px"),document.documentElement.style.setProperty("--y",i+"px"),document.documentElement.style.setProperty("--r",o+"px"),document.startViewTransition?document.startViewTransition(()=>{e.call(this)}):this.currentScheme==="light"?S(n,()=>{e.call(this)}):(e.call(this),L(n))}},T=p;function h(t){let e;return()=>{e&&window.cancelAnimationFrame(e),e=window.requestAnimationFrame(()=>t())}}var F=".article-content h1[id], .article-content h2[id], .article-content h3[id], .article-content h4[id], .article-content h5[id], .article-content h6[id]",b="#TableOfContents",x="#TableOfContents li",M="active-class";function _(t,e){let n=t.querySelector("a").offsetHeight,l=t.offsetTop-e.offsetHeight/2+n/2-e.offsetTop;l<0&&(l=0),e.scrollTo({top:l,behavior:"smooth"})}function O(t){let e={};return t.forEach(n=>{let i=n.querySelector("a").getAttribute("href");i.startsWith("#")&&(e[i.slice(1)]=n)}),e}function H(t){let e=[];return t.forEach(n=>{e.push({id:n.id,offset:n.offsetTop})}),e.sort((n,l)=>n.offset-l.offset),e}function k(){let t=document.querySelectorAll(F);if(!t){console.warn("No header matched query",t);return}let e=document.querySelector(b);if(!e){console.warn("No toc matched query",b);return}let n=document.querySelectorAll(x);if(!n){console.warn("No navigation matched query",x);return}let l=H(t),i=!1;e.addEventListener("mouseenter",h(()=>i=!0)),e.addEventListener("mouseleave",h(()=>i=!1));let o,r=O(n);function s(){let d=document.documentElement.scrollTop||document.body.scrollTop,c;l.forEach(g=>{d>=g.offset-20&&(c=document.getElementById(g.id))});let a;c&&(a=r[c.id]),c&&!a?console.debug("No link found for section",c):a!==o&&(o&&o.classList.remove(M),a&&(a.classList.add(M),i||_(a,e)),o=a)}window.addEventListener("scroll",h(s));function m(){l=H(t),s()}window.addEventListener("resize",h(m))}var R="a[href]";function P(){document.querySelectorAll(R).forEach(t=>{t.getAttribute("href").startsWith("#")&&t.addEventListener("click",n=>{n.preventDefault();let l=decodeURI(t.getAttribute("href").substring(1)),i=document.getElementById(l),o=i.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;window.history.pushState({},"",t.getAttribute("href")),scrollTo({top:o,behavior:"smooth"})})})}var C={init:()=>{w();let t=document.querySelector(".article-content");if(t){f.createGallery(t);let i=t.querySelectorAll("div.gallery");for(let o=0;o<i.length;o++){let r=i[o];new f(r,o)}P(),k()}let e=document.querySelectorAll(".article-content div.highlight"),n="Copy",l="Copied!";e.forEach(i=>{y(i);let o=document.createElement("button");o.innerHTML=n,o.classList.add("copyCodeButton"),i.appendChild(o);let r=i.querySelector("code[data-lang]");r&&o.addEventListener("click",()=>{navigator.clipboard.writeText(r.textContent).then(()=>{o.textContent=l,setTimeout(()=>{o.textContent=n},1e3)}).catch(s=>{alert(s),console.log("Something went wrong",s)})})}),new T(document.getElementById("dark-mode-toggle"))}};window.addEventListener("load",()=>{setTimeout(function(){C.init()},0)});window.Stack=C;window.createElement=E;})();
/*!
*   Hugo Theme Stack
*
*   @author: Jimmy Cai
*   @website: https://jimmycai.com
*   @link: https://github.com/CaiJimmy/hugo-theme-stack
*/
